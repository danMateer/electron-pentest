# Improper Use of Preload Scripts

# [OWASP Desktop App Security Top 10 (2021) Risk](https://github.com/OWASP/www-project-desktop-app-security-top-10/blob/main/tab_detaileddescription.md#owasp-top-10-desktop-application-security-risks-2021--detailed-description)
OWASP Top 10 2021 DA6: Security Misconfiguration

# Description
Despite disabling `nodeIntegration` and enabling `sandbox`, preload scripts have access to Node.js APIs. When node integration is turned off, the preload script can reintroduce Node global symbols back to the global scope. Improper use of preload scripts can introduce bypasses in addition to other vulnerabilities. If context isolation is not used, there is a risk that malicious code in preload scripts could tamper JavaScript native functions that the preload script and Electron APIs make use of.

# Instruction
Search for preload within the `webPreferences` of `BrowserWindow`. Review the imported scripts.

If `preload` is used, make sure that `webPreferences` also includes `contextIsolation: true` or `contextIsolation: 1`.

_[Source](https://doyensec.com/resources/us-17-Carettoni-Electronegativity-A-Study-Of-Electron-Security-wp.pdf)_

**Tools**
- [Electronegativity](https://github.com/doyensec/electronegativity)

**Additional Resources**
- [Electron Security: Disable or limit navigation](https://www.electronjs.org/docs/latest/tutorial/security#13-disable-or-limit-navigation)
