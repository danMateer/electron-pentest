# User Host Compromise

# [OWASP Desktop App Security Top 10 (2021) Risk](https://github.com/OWASP/www-project-desktop-app-security-top-10/blob/main/tab_detaileddescription.md#owasp-top-10-desktop-application-security-risks-2021--detailed-description)
OWASP Top 10 2021 DA1: Injections

# Description
This check involve and evaluation of Electron’s Shell primitives. These are powerful and should be used with caution. Shell’s `openExternal()` allows opening a given external protocol URI with the desktop’s native utilities. For instance, on macOS, this function is similar to the ‘open’ terminal command utility and will open the specific application based on the URI and filetype association. Improper use of `openExternal` can be leveraged to compromise the user’s host.

# Instruction
Manually review all occurrences of `openExternal` to ensure that no usersupplied content can be injected without validation. Example:
```
const {shell} = require('electron')
shell.openExternal('file:///Applications/Calculator.app')
```

_[Source](https://doyensec.com/resources/us-17-Carettoni-Electronegativity-A-Study-Of-Electron-Security-wp.pdf)_

**Tools**
- [Electronegativity](https://github.com/doyensec/electronegativity)

**Additional Resources**
- [Electron Security: Avoid usage of the file:// protocol and prefer usage of custom protocols](https://www.electronjs.org/docs/latest/tutorial/security#15-do-not-use-shellopenexternal-with-untrusted-content)
