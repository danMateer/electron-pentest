# Unsafe Custom Protocol Handlers

# [OWASP Desktop App Security Top 10 (2021) Risk](https://github.com/OWASP/www-project-desktop-app-security-top-10/blob/main/tab_detaileddescription.md#owasp-top-10-desktop-application-security-risks-2021--detailed-description)
OWASP Top 10 2021 DA8: Poor Code Quality

# Description
Electron allows to define custom protocol handlers so that the application can use mobile-like deep linking to exercise specific features. The use of custom protocol handlers opens the application to vulnerabilities triggered by users clicking on custom links or arbitrary origins forcing the navigation to crafted links. These should be carefully evaluated. Since custom protocol handlers can be triggered by arbitrary origins, it is important to evaluate how they are implemented and whether user-supplied parameters can lead to security vulnerabilities (e.g. injection flaws).

# Instruction
To register a custom protocol handler, it is necessary to use one of the following functions:
- `setAsDefaultProtocolClient`
- `registerStandardSchemes`
- `registerServiceWorkerSchemes`
- `registerFileProtocol`
- `registerHttpProtocol`
- `registerStringProtocol`
- `registerBufferProtocol`

Search for those occurrences and manually review the implementation.

_[Source](https://doyensec.com/resources/us-17-Carettoni-Electronegativity-A-Study-Of-Electron-Security-wp.pdf)_

**Tools**
- [Electronegativity](https://github.com/doyensec/electronegativity)

**Additional Resources**
- [Electron Security: Avoid usage of the file:// protocol and prefer usage of custom protocols](https://www.electronjs.org/docs/latest/tutorial/security#18-avoid-usage-of-the-file-protocol-and-prefer-usage-of-custom-protocols)
