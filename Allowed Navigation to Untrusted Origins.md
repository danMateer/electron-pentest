# Allowed Navigation to Untrusted Origins

# [OWASP Desktop App Security Top 10 (2021) Risk](https://github.com/OWASP/www-project-desktop-app-security-top-10/blob/main/tab_detaileddescription.md#owasp-top-10-desktop-application-security-risks-2021--detailed-description)
OWASP Top 10 2021 DA6: Security Misconfiguration

# Description
Navigation to untrusted origins can facilitate attacks, thus it is recommend to limit the ability of a `BrowserWindow` and `webview` guest page to initiate new navigation flows. Middle-click events can be leverage to subvert the flow of the application.

# Instruction
Creation of a new window or the navigation to a specific origin can be inspected and validated using callbacks for the `new-window` and `willnavigate` events. Your application can limit the navigation flows by implementing something like:
```
win.webContents.on('will-navigate', (event, newURL) => {
 if (win.webContents.getURL() !== ‘https://example.com’ ) {
  event.preventDefault();
 }
})
```

In the default configuration of some versions of Electron, middle-click support needs to be explicitly disabled by the application using:
```
mainWindow = new BrowserWindow({
 ""webPreferences"": {
  “disableBlinkFeatures"": “Auxclick”
  }
 });
```

_[Source](https://doyensec.com/resources/us-17-Carettoni-Electronegativity-A-Study-Of-Electron-Security-wp.pdf)_

**Tools**
- [Electronegativity](https://github.com/doyensec/electronegativity)

**Additional Resources**
- [Electron Security: Disable or limit navigation](https://www.electronjs.org/docs/latest/tutorial/security#13-disable-or-limit-navigation)
